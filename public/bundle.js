(()=>{"use strict";var t,e,n={5222:(t,e,n)=>{n(4114),n(3375),n(9225),n(3972),n(9209),n(5714),n(7561),n(6197);const o=[],i=[];class r{constructor(t,e){this.x=t,this.y=e}}class s{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radiusX=t,this.radiusY=e,this.rotation=n}scale(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.radiusX*=t,this.radiusY*=e}}class a extends s{constructor(t){super(t,t),this.radius=t}setRadius(t){super.scale(t/this.radius),this.radius=t}}class c{ratio=1;constructor(t,e){this.width=t,this.height=e,this.ratio=t/e}scale(t){this.width*=t,this.height*=t}}class l{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;this.lineOneLength=t,this.lineTwoLength=e,this.lineWidth=n}scale(t){this.lineOneLength*=t,this.lineTwoLength*=t,this.lineWidth*=t}}class h{fill=!0;stroke=!0;fillRule="nonzero";display=!0;lineCap="butt";lineJoin="miter";miterLimit=10;constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.position=t.position??new r(0,0),this.shape=t.shape??new a(10),this.fillStyle=t.fillStyle,this.strokeStyle=t.strokeStyle,this.strokeWidth=t.strokeWidth,this.fill=t.fill??!0,this.stroke=t.stroke??!0,this.fillRule=t.fillRule??"nonzero",this.display=t.display??!0,this.lineCap=t.lineCap??"butt",this.lineJoin=t.lineJoin??"miter",this.miterLimit=t.miterLimit??10}draw(t,e,n){this.display&&function(t,e){if(t.display){if(e.beginPath(),t.fillStyle&&(e.fillStyle=t.fillStyle),t.strokeStyle&&(e.strokeStyle=t.strokeStyle),t.strokeWidth&&(e.lineWidth=t.strokeWidth),t.lineCap&&(e.lineCap=t.lineCap),t.lineJoin&&(e.lineJoin=t.lineJoin),t.miterLimit&&(e.miterLimit=t.miterLimit),t.shape instanceof s)e.ellipse(t.position.x,t.position.y,t.shape.radiusX,t.shape.radiusY,t.shape.rotation,0,2*Math.PI);else if(t.shape instanceof c)e.rect(t.position.x-t.shape.width/2,t.position.y-t.shape.height/2,t.shape.width,t.shape.height);else if(t.shape instanceof l){e.lineJoin="round";let n=Math.sqrt(2),o=t.shape.lineOneLength/n,i=t.shape.lineTwoLength/n;e.moveTo(t.position.x-o/2,t.position.y-o/2),e.lineTo(t.position.x+o/2,t.position.y+o/2),e.moveTo(t.position.x-i/2,t.position.y+i/2),e.lineTo(t.position.x+i/2,t.position.y-i/2)}else console.log("Unknown shape:",t.shape);t.fill&&(e.closePath(),e.fill(t.fillRule)),t.stroke&&e.stroke()}}(this,t)}remove(){o.filter((t=>t!==this)),i.filter((t=>t!==this))}}function u(t,e){if(e.shape instanceof a)return(t.x-e.position.x)**2+(t.y-e.position.y)**2<e.shape.radius**2;if(e.shape instanceof s){const n=new r((t.x-e.position.x)*Math.cos(-e.shape.rotation)-(t.y-e.position.y)*Math.sin(-e.shape.rotation),(t.x-e.position.x)*Math.sin(-e.shape.rotation)+(t.y-e.position.y)*Math.cos(-e.shape.rotation));return(n.x/e.shape.radiusX)**2+(n.y/e.shape.radiusY)**2<=1}if(e.shape instanceof c)return t.x>=e.position.x-e.shape.width/2&&t.x<=e.position.x+e.shape.width/2&&t.y>=e.position.y-e.shape.height/2&&t.y<=e.position.y+e.shape.height/2;if(e.shape instanceof l){let n=Math.max(e.shape.lineOneLength,e.shape.lineTwoLength)/2;return(t.x-e.position.x)**2+(t.y-e.position.y)**2<n**2}}function p(t,e){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}n(6573),n(8100),n(7936),n(7467),n(4732),n(9577);let d=[];class f{constructor(t,e,n,o){this.name=t,this.render_color=e,this.chemical_formula=n,this.relative_abundance=o/5,d.push(this)}}new f("Gold","#FFD700","Au",1),new f("Iron","#D4D7D8","Fe",4),new f("Copper","#B76B1E","Cu",3),new f("Silver","#C0C0C0","Ag",2),new f("Diamond","#FFF","C",1);class y extends h{hovering=!1;listeners={};isMapElement=!1;active=!0;constructor(t){super(t),this.isMapElement=t.isMapElement??!1,this.active=this.active,v.push(this)}addEventListener(t,e,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}removeEventListener(t,e,n){this.listeners[t].filter((t=>t!==e))}dispatchEvent(t){return!!this.listeners[t.type]&&(this.listeners[t.type].forEach((e=>e(t))),!0)}remove(){super.remove(),v.splice(v.indexOf(this),1)}}const v=[],g=[];function m(t,e,n){for(let o of g)o.draw(t,e,n)}const x={WATER_THRESHOLD:.35,MOUNTAIN_THRESHOLD:.75,UPHILL_MAX_SLOPE:.7,UPHILL_MIN_SPEED:.05,DOWNHILL_BOOST_LIMIT:.2,DOWNHILL_MAX_SLOPE:.58,DOWNHILL_MAX_BOOST:3,DOWNHILL_MIN_SPEED:.15,PIXELS_TO_METERS:15,HEIGHT_RANGE:1500},w=.01,b={SHOW_PATH_LOGS:!1,SHOW_TERRAIN_LOGS:!1,DRAW_TERRAIN_GRID:!1},E={PIXELATED:!0,SCALE:10,MIN_ZOOM:1,MAX_ZOOM:200};let P=null;function S(t){if(!P?.heightMap?.data)return b.SHOW_TERRAIN_LOGS&&console.warn("World map or height map data not initialized for terrain utilities"),.5;const e=P.heightMap.data,n=e.length,o=e[0]?.length;if(!o||0===n)return.5;const i=Math.round(t.x),r=Math.round(t.y),s=Math.max(0,Math.min(i,o-1)),a=Math.max(0,Math.min(r,n-1)),c=e[a]?.[s];return c??.5}function T(t){return P?.heightMap?.data?!(S(t)<x.WATER_THRESHOLD):(b.SHOW_TERRAIN_LOGS&&console.warn("World map or height map data not initialized for terrain utilities"),!0)}function M(t,e){const n=S(t),o=S(e),i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))*x.PIXELS_TO_METERS;if(0===i)return 0;const r=(o-n)*x.HEIGHT_RANGE/i;return b.SHOW_TERRAIN_LOGS&&Math.abs(r)>.2&&console.log(`Slope from (${t.x.toFixed(1)}, ${t.y.toFixed(1)}) to (${e.x.toFixed(1)}, ${e.y.toFixed(1)}): ${r.toFixed(2)}`),r}function O(t){const{UPHILL_MAX_SLOPE:e,UPHILL_MIN_SPEED:n,DOWNHILL_BOOST_LIMIT:o,DOWNHILL_MAX_SLOPE:i,DOWNHILL_MAX_BOOST:r,DOWNHILL_MIN_SPEED:s}=x;if(t>0)return t>=e?0:1-t/e*(1-n);{const e=Math.abs(t);return e<o?1+e/o*(r-1):e<i?r-(e-o)/(i-o)*(r-s):0}}function _(t,e){const n=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);return Math.max(n,o)+(Math.SQRT2-1)*Math.min(n,o)}function A(t,e){return t.x===e.x&&t.y===e.y}function k(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e5;b.SHOW_PATH_LOGS&&console.log(`Finding path from (${t.x.toFixed(1)}, ${t.y.toFixed(1)}) to (${e.x.toFixed(1)}, ${e.y.toFixed(1)})`);const o={x:Math.round(t.x),y:Math.round(t.y)},i={x:Math.round(e.x),y:Math.round(e.y)};if(A(o,i))return[{x:o.x,y:o.y}];if(!T(o)||!T(i))return b.SHOW_PATH_LOGS&&console.warn(`Start grid pos (${o.x}, ${o.y}) or end grid pos (${i.x}, ${i.y}) is impassable (water).`),null;const r=[],s=new Set,a=new Map,c=t=>`${t.x},${t.y}`,l=[{x:0,y:1},{x:1,y:0},{x:0,y:-1},{x:-1,y:0},{x:1,y:1},{x:1,y:-1},{x:-1,y:-1},{x:-1,y:1}],h={x:i.x-o.x,y:i.y-o.y},u=Math.sqrt(h.x*h.x+h.y*h.y);u>0&&(h.x/=u,h.y/=u,l.sort(((t,e)=>{const n=t.x*h.x+t.y*h.y;return e.x*h.x+e.y*h.y-n})));const p=_(o,i),d={position:{x:o.x,y:o.y},gCost:0,hCost:p,fCost:p,parent:null};r.push(d),a.set(c(o),d);let f=0;const y=8*n;for(;r.length>0&&f<y;){f++;let n=0;for(let t=1;t<r.length;t++)r[t].fCost<r[n].fCost&&(n=t);const o=r[n];r.splice(n,1);const h=c(o.position);if(s.add(h),A(o.position,i)){b.SHOW_PATH_LOGS&&console.log(`Path found after ${f} iterations`);const n=[];let i=o;for(;null!==i;)n.push({x:i.position.x,y:i.position.y}),i=i.parent;return n.reverse(),n.length>0&&(n[0]={x:t.x,y:t.y},n[n.length-1]={x:e.x,y:e.y}),n}for(const t of l){const e={x:o.position.x+t.x,y:o.position.y+t.y},n=c(e);if(s.has(n))continue;if(!T(e))continue;const l=0!==t.x&&0!==t.y;if(l){const e={x:o.position.x+t.x,y:o.position.y},n={x:o.position.x,y:o.position.y+t.y};if(!T(e)||!T(n))continue}let h=l?1.41421356:1;const u=O(M(o.position,e));if(u<=w)continue;h/=u;const p=o.gCost+h,d=a.get(n);if(d)p<d.gCost&&(d.gCost=p,d.fCost=p+d.hCost,d.parent=o,r.includes(d)||r.push(d));else{const t=_(e,i),s={position:{x:e.x,y:e.y},gCost:p,hCost:t,fCost:p+t,parent:o};r.push(s),a.set(n,s)}}}return b.SHOW_PATH_LOGS&&console.warn(`No path found after ${f} iterations`),null}let I=null,L="default";function D(t){I=t,L="Move"===t||"Mine"===t||"AddDropOff"===t?"move":"Build"===t?"build":"default"}const C=[];class R{constructor(t){let{name:e,materials:n,durability:o,toBuild:i,toDestroy:r,retrievable:s=.5,initThing:a,update:c=(()=>{}),build:l=null}=t;this.name=e,this.materials=n,this.durability=o,this.toBuild=i,this.toDestroy=r,this.retrievable=s,this.build=l,this.update=c,this.initThing=a,C.push(this)}}class H{scale=1;constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.type=t,this.integrity=1,this.thing=t.initThing(e),this.thing.addEventListener("click",(t=>{if(console.log("Structure clicked"),"Mine"===I){const t=j.getSelectedEntity();if(t instanceof V)return t.setTargetPosition(this.thing.position),D(null),void t.addEventListener("arrived",(()=>{t.setTask({type:"mine",target:this})}),{once:!0})}}))}draw(t,e,n){this.thing.draw(t,e,n),this.type.update(n,t,this),this.integrity<=0&&this.thing.remove()}}const B=new class{visible=!1;buttons=[];setupButtons(){this.buttons=[];for(let t=0;t<C.length;t++){let e=C[t];if(!e.build)continue;let n=new y({isMapElement:!1,shape:new c(100,100),fill:!0,fillStyle:"rgb(220, 200, 150)",stroke:!1,display:this.visible});n.addEventListener("click",(t=>{console.log("click!!"),this.hide(),e.build()})),this.buttons.push({element:n,structureType:e})}}hide(){this.visible=!1;for(let t of this.buttons)t.element.display=!1,t.element.active=!1}show(){this.visible=!0;for(let t of this.buttons)t.element.display=!0,t.element.active=!0}draw(t,e,n){if(!this.visible)return;t.fillStyle="rgba(75, 75, 125, 0.6)",t.fillRect(30,30,n.canvasWidth-60,n.canvasHeight-60);let o=new r(0,0);for(let i=0;i<this.buttons.length;i++){let s=this.buttons[i];s.element.position=new r(60+130*o.x+50,60+130*o.y+50),s.element.draw(t,e,n),t.fillStyle="black",t.font="bold 16px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(s.structureType.name,s.element.position.x,s.element.position.y),o.x++,120+130*o.x>=n.canvasWidth&&(o.y++,o.x=0)}}};i.push(B);const j=new class{actions=[];visible=!0;selectedEntity=null;actionButtons=[];constructor(){this.position={x:0,y:0},this.size={x:300,y:100},this.updatePosition()}updatePosition(){const t=document.getElementById("canvas");t&&(this.position={x:20,y:t.height-this.size.y-20})}setSelectedEntity(t){this.selectedEntity=t,this.updateActions()}getSelectedEntity(){return this.selectedEntity}updateActions(){if(this.actions=[],this.clearActionButtons(),this.selectedEntity)if(this.selectedEntity instanceof N){let t=this.selectedEntity;this.actions.push({name:"Delete",description:"Delete this drop off location",execute:()=>{t.remove()},available:()=>!0})}else this.selectedEntity instanceof V&&(this.actions.push({name:"Move",description:"Move this person to a new location",execute:()=>{D("Move"),console.log("Move action selected")},available:()=>!0}),this.actions.push({name:"Mine",description:"Assign this person to mine",execute:()=>{console.log("Mine action selected"),D("Mine")},available:()=>!0}),this.actions.push({name:"Build",description:"Build a structure",execute:()=>{console.log("Build action selected"),B.show()},available:()=>!0}));else this.actions.push({name:"+ dropoff",description:"Add drop off location",execute:()=>{console.log("Add drop off action selected"),D("AddDropOff")},available:()=>!0});this.createActionButtons()}createActionButtons(){this.actions.forEach(((t,e)=>{if(t.available()){const n=this.position.x+10+70*e,o=this.position.y+10,i=new y({shape:new c(60,60),position:{x:n+30,y:o+30},fillStyle:"rgba(50, 150, 200, 0.8)",strokeStyle:"white"});console.log("Creating button:",t.name),i.addEventListener("click",(e=>{console.log("click"),t.execute()})),this.actionButtons.push(i)}}))}clearActionButtons(){this.actionButtons.forEach((t=>t.remove())),this.actionButtons=[]}draw(t){if(!this.visible)return;t.fillStyle="rgba(30, 35, 50, 0.8)",t.fillRect(this.position.x,this.position.y,this.size.x,this.size.y),t.strokeStyle="rgba(100, 150, 200, 0.7)",t.lineWidth=2,t.strokeRect(this.position.x,this.position.y,this.size.x,this.size.y);this.actions.forEach(((e,n)=>{if(e.available()){const o=this.position.x+10+70*n,i=this.position.y+10;t.fillStyle="rgba(50, 100, 150, 0.8)",t.fillRect(o,i,60,60),t.strokeStyle="rgba(150, 200, 255, 0.9)",t.lineWidth=2,t.strokeRect(o,i,60,60),t.fillStyle="white",t.font="bold 16px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(e.name,o+30,i+30)}}))}};class N extends y{stock=[];constructor(t){super({shape:new a(10),position:t,fillStyle:"#FF0000",strokeStyle:"#000000",strokeWidth:1,isMapElement:!0}),this.location=t,this.addEventListener("click",(t=>{console.log("Dropoff location clicked"),j.setSelectedEntity(this)})),W.push(this)}dropMaterial(t){Array.isArray(t)?this.stock.push(...t):this.stock.push(t)}remove(){W.splice(W.indexOf(this),1),super.remove()}}const W=[];class z{}var F=function(t){return t[t.weapon=0]="weapon",t[t.armor=1]="armor",t[t.constructionTool=2]="constructionTool",t[t.miningTool=3]="miningTool",t[t.choppingTool=4]="choppingTool",t[t.fishingTool=5]="fishingTool",t[t.food=6]="food",t[t.drink=7]="drink",t[t.commodity=8]="commodity",t}(F||{});class ${constructor(t,e,n){this.type=t,this.effectiveness=e,this.durability=n}}class U{constructor(t,e,n){this.name=t,this.uses=e,this.weight=n}}class G{constructor(t,e){this.item=t,this.count=e}}class V{targetPosition=null;path=[];currentPathIndex=0;isMoving=!1;listeners={};retries=0;overshotFactor=0;constructor(t,e,n,o){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Map;this.physical=t,this.mental=e,this.position=n,this.YOB=o,this.money=i,this.possessions=r,this.skills=s}setTask(t){this.task=t}getTotalCurrentCarryingWeight(){return this.possessions.reduce(((t,e)=>t+e.count*e.item.weight),0)}setTargetPosition(t){const e=k(this.position,t);e&&0!==e.length?(this.targetPosition={...t},this.path=e,this.currentPathIndex=0,this.isMoving=!0):console.warn("No valid path found to target")}update(t,e){if(W.sort(((t,e)=>p(this.position,t.location)-p(this.position,e.location))),!this.isMoving&&this.task){const e=this.task.target;!e||e.integrity<=0?this.task=null:"mine"===this.task.type?this.handleMiningTask(e,t):"build"===this.task.type&&this.handleBuildTask(e,t)}this.updateMovement(t,e)}handleMiningTask(t,e){const n=W.length>0&&0===p(this.position,W[0].location),o=this.getTotalCurrentCarryingWeight()>=.9*this.physical.strength;if(console.log(o,this.getTotalCurrentCarryingWeight(),this.physical.strength,this.possessions),n){for(const t of this.possessions)W[0].dropMaterial(t);this.possessions=[]}else if(o&&!this.isMoving&&W.length>0)for(const t of W){const e=k(this.position,t.location);if(e&&e.length>0)return void this.setTargetPosition(t.location)}p(this.position,t.thing.position)>=1?this.setTargetPosition(t.thing.position):this.mineTarget(t,e)}mineTarget(t,e){if(t.integrity<=0)return t.thing.remove(),void(this.task=null);const n=t.type.durability,o=this.physical.strength,i=t.type.retrievable,r=Math.min(e*o*.1/n,t.integrity);t.integrity-=r,console.log(t.integrity);for(let e of t.type.materials){let n=this.possessions.find((t=>t.item===e.item));n||(n=new G(e.item,0),this.possessions.push(n)),console.log(e,r,i,t.scale),n.count+=e.count*r*i*t.scale}t.integrity<=0&&(t.thing.remove(),this.task=null)}handleBuildTask(t,e){p(this.position,t.thing.position)>=1?this.setTargetPosition(t.thing.position):t.integrity>=1&&(this.task=null)}updateMovement(t,e){if(!this.isMoving||!this.targetPosition||0===this.path.length)return!0;const n=this.path[this.currentPathIndex],o=n.x-this.position.x,i=n.y-this.position.y,r=p(this.position,n);if(r<1)return this.currentPathIndex++,this.currentPathIndex>=this.path.length&&(console.log("Reached final destination"),this.position={...this.targetPosition},this.isMoving=!1,this.retries=0,this.targetPosition=null,this.path=[],this.currentPathIndex=0,this.dispatchEvent({...e,type:"arrived",targetPosition:this.targetPosition}),!0);const s=this.physical.speed,a=this.overshotFactor,c=this.position;function l(e){const n=20*s*e*(t/1e3)+a*e,l=o/r,h=i/r;return{x:c.x+l*n,y:c.y+h*n}}let h=0,u=-1,d=l(1),f=1,y=0;for(;f>=w&&y<10;){h=M(this.position,d);let t=O(h);f=Math.abs(t-u),u=Math.max(t,w),d=l(u),y++}this.overshotFactor=0;const{x:v,y:g}=d;if(T({x:v,y:g})&&u>0){const t=this.position.x<n.x&&v>n.x||this.position.x>n.x&&v<n.x,e=this.position.y<n.y&&g>n.y||this.position.y>n.y&&g<n.y,o=t?Math.abs((v-n.x)/(n.x-this.position.x)):0,i=e?Math.abs((g-n.y)/(n.y-this.position.y)):0;this.overshotFactor=Math.max(o,i)/u,t||e?(this.position.x=n.x,this.position.y=n.y):(this.position.x=v,this.position.y=g)}else{if(!(this.retries<5))return console.log("Max retries reached, giving up"),this.isMoving=!1,this.targetPosition=null,this.path=[],this.currentPathIndex=0,this.retries=0,this.dispatchEvent({...e,type:"failed",targetPosition:this.targetPosition}),!0;{console.log("Path blocked by impassable terrain. Finding new path...");const t=this.path[this.currentPathIndex+1],e=k(this.position,t);if(e)this.path.splice(this.currentPathIndex+1,0,...e);else{const t=k(this.position,this.targetPosition);t&&(this.path=t,this.currentPathIndex=0)}this.retries++}}return!1}addEventListener(t,e,n){this.listeners[t]||(this.listeners[t]=[]),n&&n.once?this.listeners[t].push((n=>{e(n),this.removeEventListener(t,e)})):this.listeners[t].push(e)}removeEventListener(t,e,n){this.listeners[t]=this.listeners[t].filter((t=>t!==e))}dispatchEvent(t){return console.log("Dispatching event:",t),!!this.listeners[t.type]&&(this.listeners[t.type].forEach((e=>e(t))),!0)}}const X=new U("Wood",[new $(F.commodity,1,1)],20),q=new U("Stone",[new $(F.commodity,3,2)],80);function Y(t,e){let n=0,o=0;for(;0===n;)n=Math.random();for(;0===o;)o=Math.random();return t+e*Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*o)}class Z{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.people=[],this.color=e,this.name=t,this.isPlayerNation=n,this.possessions=[],this.money=0}addPerson(t){this.people.push(t)}removePerson(t){const e=this.people.indexOf(t);-1!==e&&this.people.splice(e,1)}createPerson(t){const e=Y(85,35),n={height:Y(1.77,.08),weight:e,strength:Y(.4,.1)*e,speed:Y(2,.3)},o=new z;o.problem_solving=Y(5,2),o.knowledge=Y(5,2),o.creativity=Y(5,2);const i=15+Math.floor(60*Math.random()),r=new V(n,o,t,1e3-i);return this.addPerson(r),r}}const J=new class{nations=[];playerNation=null;constructor(){}addNation(t){this.nations.push(t),t.isPlayerNation&&(this.playerNation=t)}getNations(){return this.nations}getPlayerNation(){return this.playerNation}};class K extends y{selected=!1;constructor(t,e){super({shape:new a(1),position:t.position,fillStyle:`rgba(${255*e.color[0]}, ${255*e.color[1]}, ${255*e.color[2]}, ${e.color[3]})`,strokeStyle:"white",strokeWidth:.5,isMapElement:!0}),this.person=t,this.nation=e,this.originalRadius=1,function(t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/150,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1.5,o=1,i=!1,r=null;const s=t.draw;t.draw=function(a,c,l){t.hovering&&!i?(r=performance.now(),i=!0):!t.hovering&&i&&(r=null,i=!1);let h=o;if(i&&null!==r){let t=c*e;o=Math.min(o+t,n)}else if(!i){let t=c*e;o=Math.max(o-t,1)}t.shape.scale(o/h),s.call(t,a,c)}}(this,1.3),this.addEventListener("click",(t=>{this.selected?this.deselect():this.select()}))}select(){Q.deselectAll(),this.selected=!0,this.strokeStyle="yellow",this.strokeWidth=.25,j.setSelectedEntity(this.person),console.log(`Selected person from ${this.nation.name}`),console.log(`Person attributes: Strength: ${this.person.physical.strength.toFixed(1)}, Speed: ${this.person.physical.speed.toFixed(1)}`)}deselect(){this.selected=!1,this.strokeStyle="white",this.strokeWidth=.25,j.getSelectedEntity()===this.person&&j.setSelectedEntity(null)}draw(t,e,n){if(this.person.isMoving&&this.person.path.length>0){t.beginPath(),t.moveTo(this.position.x,this.position.y);const e=this.person.path[this.person.currentPathIndex];if(t.lineTo(e.x,e.y),this.person.currentPathIndex<this.person.path.length-1)for(let e=this.person.currentPathIndex+1;e<this.person.path.length;e++)t.lineTo(this.person.path[e].x,this.person.path[e].y);t.strokeStyle="rgba(255, 255, 0, 0.4)",t.lineWidth=.5,t.stroke()}if(super.draw(t,e,n),this.selected){const e=.2*Math.sin(Date.now()/200)+1.2,n=this.shape.radius*e;t.beginPath(),t.arc(this.position.x,this.position.y,n,0,2*Math.PI),t.strokeStyle="rgba(255, 255, 0, 0.5)",t.lineWidth=1,t.stroke()}}isSelected(){return this.selected}getPerson(){return this.person}updatePosition(){this.position=this.person.position}moveTo(t){this.person.setTargetPosition(t),console.log(`Person moving to (${t.x.toFixed(0)}, ${t.y.toFixed(0)})`)}update(t,e){this.person.update(t,e),this.position={...this.person.position}}}class Q{static personVisuals=[];static addPersonVisual(t){this.personVisuals.push(t)}static removePersonVisual(t){const e=this.personVisuals.indexOf(t);-1!==e&&this.personVisuals.splice(e,1)}static getPersonVisuals(){return this.personVisuals}static deselectAll(){this.personVisuals.forEach((t=>{t.deselect()}))}static createPersonVisual(t,e){const n=new K(t,e);return this.addPersonVisual(n),n}static updateAll(t,e){this.personVisuals.forEach((n=>{n.update(t,e)}))}}let tt,et;const nt=document.getElementById("canvas"),ot=nt.getContext("2d");let it=window.devicePixelRatio,rt=window.innerWidth*it,st=window.innerHeight*it;const at=[{threshold:x.WATER_THRESHOLD,color:[.5,.5,1/x.WATER_THRESHOLD]},{threshold:x.MOUNTAIN_THRESHOLD,color:[.8,1/x.MOUNTAIN_THRESHOLD,.55]}];let ct={x:0,y:0,zoom:1,move_speed:1,zoom_speed:.001,realZoom:1},lt=new Set,ht=0,ut=0,pt=new c(157*E.SCALE,100*E.SCALE);const dt=1*pt.width,ft=1*pt.height;let yt={width:1,height:1};const vt=["left","right","middle","back","forward"];let gt=!0,mt=0,xt="Generating world...";new R({name:"stone wall",materials:[new G(q,100)],durability:200,toBuild:F.miningTool,toDestroy:F.miningTool,retrievable:.5,initThing:t=>new y({isMapElement:!0,shape:new c(t.width,t.height),fillStyle:"#808080",...t})});const wt=new R({name:"wood wall",materials:[new G(X,1)],durability:100,toBuild:F.choppingTool,toDestroy:F.choppingTool,retrievable:.5,initThing:t=>new y({isMapElement:!0,shape:new c(t.width,t.height),fillStyle:"#654321",stroke:!1,...t}),build:()=>{console.log("begin build");const t=new H(wt,{width:1,height:1});let e,n,o;t.integrity=1e-10,D("resize");let i=!0;const r=t=>{console.log("mousedown, set start"),e=Tt({x:t.clientX*it,y:t.clientY*it})},s=r=>{if(console.log("mousemove"),e){n=Tt({x:r.clientX*it,y:r.clientY*it}),t.thing.shape.width=Math.abs(e.x-n.x),t.thing.shape.height=Math.abs(e.y-n.y),t.thing.position={x:e.x+(n.x-e.x)/2,y:e.y+(n.y-e.y)/2},o=Math.abs(e.x-n.x)*Math.abs(e.y-n.y),t.scale=o;const s=function(){const t=[];for(let e of W)for(let n of e.stock){let e=t.find((t=>t.item===n.item));e||(e=new G(n.item,0),t.push(e)),e.count+=n.count}return t}();for(let e of t.type.materials){let t=s.find((t=>t.item===e.item));if(!t||t.count<e.count*o){i=!1;break}}console.log(s,t.type.materials,t.scale),t.thing.fillStyle=i?"#654321":"#ff0000"}},a=o=>{if(e&&n){if(c(),!i)return t.thing.remove(),alert("Not enough materials!");const e=j.getSelectedEntity();e instanceof V&&e.setTask({type:"build",target:t}),console.log("construction begun.")}else e=n=null},c=()=>{window.removeEventListener("pointerdown",r),window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",a)};window.addEventListener("pointerdown",r),window.addEventListener("pointermove",s),window.addEventListener("pointerup",a)}}),bt=new R({name:"tree",materials:[new G(X,100)],durability:100,toBuild:F.choppingTool,toDestroy:F.choppingTool,retrievable:1,initThing:t=>new y({isMapElement:!0,shape:new a(t.radius),fillStyle:"#654321",...t})});let Et={canvasPosition:{x:rt/2,y:rt/2},mapPosition:new r(0,0),canvasHeight:st,canvasWidth:rt,mapHeight:ft,mapWidth:dt,canvas:nt,canvasRenderingContext2D:ot,elapsed:ut,type:"mouseover",mouseButtons:{left:!1,right:!1,middle:!1,back:!1,forward:!1}};Et.mapPosition=Tt(Et.canvasPosition);class Pt{constructor(){this.pressed=!1,this.pressed_time=0,this.pressed_position={x:0,y:0},this.pressed_position_map={x:0,y:0}}}let St={left:new Pt,right:new Pt,middle:new Pt,back:new Pt,forward:new Pt};function Tt(t){let e=Math.min(yt.width,yt.height);return{x:ct.x/e+t.x/(e*ct.zoom),y:ct.y/e+t.y/(e*ct.zoom)}}function Mt(t){let e=function(t,e,n,o){const{min:i,max:r,data:s}=t,a=new Uint8ClampedArray(e*n*4);o.sort(((t,e)=>t.threshold-e.threshold));let c=0;for(let t=0;t<n;t++)for(let n=0;n<e;n++){const e=s[t][n],i=255*e;let r=i,l=i,h=i;for(const t of o)if(e<t.threshold){r=t.color[0]*i,l=t.color[1]*i,h=t.color[2]*i;break}a[c++]=r,a[c++]=l,a[c++]=h,a[c++]=255}return console.log("Map rendered!"),new ImageData(a,e,n)}(t,pt.width,pt.height,at);createImageBitmap(e).then((t=>{et=t,gt=!1}))}function Ot(t,e){return Boolean(t&1<<vt.indexOf(e))}function _t(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Et.mapPosition=Tt(Et.canvasPosition),v.forEach((e=>{let n=e.hovering;if(e.isMapElement)e.hovering=u(Et.mapPosition,e);else{if(t)return;e.hovering=u(Et.canvasPosition,e)}!1===n&&!0===e.hovering?e.dispatchEvent(At("mouseover")):!0===n&&!1===e.hovering&&e.dispatchEvent(At("mouseout"))}))}function At(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{...Et,type:t,...e}}function kt(t){t.preventDefault();let e=performance.now(),n=t.type,o=t.buttons,i={x:t.clientX*it,y:t.clientY*it};if(Et=At(n,{canvasPosition:i,mouseButtons:{left:Ot(o,"left"),right:Ot(o,"right"),middle:Ot(o,"middle"),back:Ot(o,"back"),forward:Ot(o,"forward")}}),"pointerdown"===n&&Ot(o,"right")){const e=j.getSelectedEntity();if(e instanceof V){const n=Q.getPersonVisuals().find((t=>t.getPerson()===e));if(n)return n.moveTo(Et.mapPosition),void t.preventDefault()}}if("Move"===I&&"pointerdown"===n&&Ot(o,"left")){const t=j.getSelectedEntity();if(t instanceof V){const e=Q.getPersonVisuals().find((e=>e.getPerson()===t));if(e)return e.moveTo(Et.mapPosition),void D(null)}}if("AddDropOff"===I&&"pointerdown"===n&&Ot(o,"left")){const t=new N(Et.mapPosition);v.push(t),D(null)}_t();for(let n of vt){let r=Ot(o,n),s=St[n];if(r&&!s.pressed)s.pressed=!0,s.pressed_time=e,s.pressed_position={...i},s.pressed_position_map={...Et.mapPosition},2===t.button&&t.preventDefault(),Et.type="pointerdown",Et.mouseButtons[n]=!0;else if(!r&&s.pressed){s.pressed=!1;let t=e-s.pressed_time,o=p(s.pressed_position,i),r=s.pressed_position,a=s.pressed_position_map,c=s.pressed_time;if(t<250&&o<8){for(let i of v)if(i.active){if(i.isMapElement&&u(a,i)){i.dispatchEvent(At("click",{click:{startPosition:r,startPositionOnMap:a,endPosition:Et.canvasPosition,endPositionOnMap:Et.mapPosition,startTime:c,endTime:e,duration:t,distanceMoved:o,button:n}}));break}if(!i.isMapElement&&u(r,i)){i.dispatchEvent(At("click",{click:{startPosition:r,startPositionOnMap:a,endPosition:Et.canvasPosition,endPositionOnMap:Et.mapPosition,startTime:c,endTime:e,duration:t,distanceMoved:o,button:n}}));break}}}else for(let i of v)if(u(a,i)){i.dispatchEvent(At("drag",{click:{startPosition:r,startPositionOnMap:a,endPosition:Et.canvasPosition,endPositionOnMap:Et.mapPosition,startTime:c,endTime:e,duration:t,distanceMoved:o,button:n}}));break}}}}function It(t){var e;e=Math.min(Math.max(E.MIN_ZOOM,ct.zoom+t),E.MAX_ZOOM),ct.x=Et.canvasPosition.x/ct.zoom-Et.canvasPosition.x/e+ct.x,ct.y=Et.canvasPosition.y/ct.zoom-Et.canvasPosition.y/e+ct.y,ct.zoom=e}new r(0,0),window.addEventListener("pointermove",kt),window.addEventListener("pointerdown",kt),window.addEventListener("pointerup",kt),window.addEventListener("contextmenu",(t=>{t.preventDefault()}),!1),window.addEventListener("wheel",(t=>{let e=t.deltaX,n=t.deltaY,o=t.deltaZ;!0===t.ctrlKey?(t.preventDefault(),It(-n/50)):(ct.x+=e/ct.zoom,ct.y+=n/ct.zoom,It(o/50),_t(!0))}),{passive:!1}),window.addEventListener("keydown",(t=>{lt.add(t.key.toLowerCase())})),window.addEventListener("keyup",(t=>{lt.delete(t.key.toLowerCase()),"t"==t.key?Mt(tt.heatMap):"h"==t.key?Mt(tt.heightMap):"i"==t.key?Mt(tt.materialMap.Iron):"g"==t.key?Mt(tt.materialMap.Gold):"Escape"==t.key&&B.hide()}));let Lt=t=>t.preventDefault(),Dt={passive:!1};function Ct(){it=window.devicePixelRatio,rt=window.innerWidth*it,st=window.innerHeight*it,nt.width=rt,nt.height=st,yt.width=rt/dt,yt.height=st/ft,Et.canvasWidth=rt,Et.canvasHeight=st,j.updatePosition(),j.updateActions()}document.addEventListener("wheel",Lt,Dt),document.addEventListener("dblclick",Lt,Dt),document.addEventListener("touchstart",Lt,Dt),document.addEventListener("gesturestart",Lt,Dt),document.addEventListener("gesturechange",Lt,Dt),document.addEventListener("gestureend",Lt,Dt),window.addEventListener("gamepadconnected",(t=>{console.log(`Gamepad connected at index ${t.gamepad.index}: ${t.gamepad.id}. \n    ${t.gamepad.buttons.length} buttons, ${t.gamepad.axes.length} axes.`)})),window.addEventListener("gamepaddisconnected",(t=>{console.log(`Gamepad disconnected from index ${t.gamepad.index}: ${t.gamepad.id}`)})),Ct(),async function(){gt=!0,mt=0,xt="Initializing...",console.log("Initializing game..."),B.setupButtons();const t=new Z("Player Nation",[0,.5,.8,1],!0);t.color=[0,.6,.9,1],J.addNation(t),console.log("Player nation created:",t),console.log("Creating 15 people...");for(let e=0;e<15;e++){let e=0,n=0;do{e=Math.random()*dt,n=Math.random()*ft}while(S({x:e,y:n})<=x.WATER_THRESHOLD||S({x:e,y:n})>=x.MOUNTAIN_THRESHOLD);const o=t.createPerson({x:e,y:n});Q.createPersonVisual(o,t),console.log(`Created person at position (${e.toFixed(0)}, ${n.toFixed(0)})`)}console.log("Total people created:",Q.getPersonVisuals().length),fetch("/generate-map",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({width:pt.width,height:pt.height})}).then((t=>t.json())).then((t=>{tt=t.map,P=tt,console.log("Terrain utils initialized with world map:",P?"success":"failed"),console.log("Terrain utilities initialized with map data"),Mt(tt.heightMap),console.log("Map loaded, game ready!");for(let t=0;t<200;t++){let t=0,e=0;do{t=Math.random()*dt,e=Math.random()*ft}while(S({x:t,y:e})<=x.WATER_THRESHOLD||S({x:t,y:e})>=x.MOUNTAIN_THRESHOLD);new H(bt,{position:{x:t,y:e},radius:3})}gt=!1}))}(),async function t(e){ut=e-ht,ht=e,function(t){if(Et.elapsed=t,gt)return void function(){ot.fillStyle="black",ot.fillRect(0,0,rt,st),ot.font="bold 40px Sans-serif",ot.fillStyle="white",ot.textAlign="center",ot.textBaseline="middle",ot.fillText("Civilization Game",rt/2,st/3),ot.font="30px Sans-serif",ot.fillText(xt,rt/2,st/2);const t=.6*rt,e=rt/2-t/2,n=st/2+50;ot.fillStyle="#333",ot.fillRect(e,n,t,20),ot.fillStyle="#4CAF50",ot.fillRect(e,n,t*(mt/100),20),ot.font="16px Sans-serif",ot.fillStyle="white",ot.fillText(`${mt}%`,rt/2,n+20+20)}();if(ot.clearRect(0,0,rt,st),ot.fillStyle="lightblue",ot.fillRect(0,0,rt,st),!et)return;!function(t){let e=!1;const n=navigator.getGamepads();for(const o of n)if(o){o.buttons[7]&&o.buttons[7].value>.1&&It(t*ct.zoom_speed*ct.zoom*o.buttons[7].value),o.buttons[6]&&o.buttons[6].value>.1&&It(-t*ct.zoom_speed*ct.zoom*o.buttons[6].value);const n=.1,i=3;let r=!1;(Math.abs(o.axes[0])>n||Math.abs(o.axes[1])>n)&&(Et.canvasPosition.x+=o.axes[0]*i*t,Et.canvasPosition.y+=o.axes[1]*i*t,Et.canvasPosition.x=Math.max(0,Math.min(rt,Et.canvasPosition.x)),Et.canvasPosition.y=Math.max(0,Math.min(st,Et.canvasPosition.y)),_t(),r=!0);const s=.1,a=3;Math.abs(o.axes[2])>s&&(ct.x+=t*ct.move_speed*o.axes[2]*a/ct.zoom,e=!0),Math.abs(o.axes[3])>s&&(ct.y+=t*ct.move_speed*o.axes[3]*a/ct.zoom,e=!0),o.buttons[0]&&o.buttons[0].pressed?Et.mouseButtons.left||(Et.mouseButtons.left=!0,St.left.pressed=!0,St.left.pressed_time=performance.now(),St.left.pressed_position={...Et.canvasPosition},St.left.pressed_position_map={...Et.mapPosition}):Et.mouseButtons.left&&(Et.mouseButtons.left=!1)}lt.has("-")&&It(-t*ct.zoom_speed*ct.zoom),lt.has("=")&&It(t*ct.zoom_speed*ct.zoom),lt.has("arrowleft")&&(ct.x-=t*ct.move_speed/ct.zoom,e=!0),lt.has("arrowright")&&(ct.x+=t*ct.move_speed/ct.zoom,e=!0),lt.has("arrowup")&&(ct.y-=t*ct.move_speed/ct.zoom,e=!0),lt.has("arrowdown")&&(ct.y+=t*ct.move_speed/ct.zoom,e=!0),e&&_t(!0)}(t),Q.updateAll(t,Et),ot.save();try{ct.realZoom=ct.zoom*Math.min(yt.width,yt.height),ot.translate(-ct.x*ct.zoom,-ct.y*ct.zoom),ot.scale(ct.realZoom,ct.realZoom),ot.imageSmoothingEnabled=!E.PIXELATED,ot.drawImage(et,0,0,dt,ft);for(let e of v)e.display&&e.isMapElement&&e.draw(ot,t,Et);for(let e of o)e.draw(ot,t,Et)}finally{ot.restore()}!function(t){Et.elapsed=t;for(let e of v)e.display&&!e.isMapElement&&e.draw(ot,t,Et);m(ot,t,Et)}(t),j.draw(ot),function(t,e,n){let o=t.split("\n");for(let t=0;t<o.length;t++){let n=o[t];ot.font="30px Sans-serif",ot.strokeStyle="black",ot.lineWidth=5,ot.strokeText(n,e,80+35*t),ot.fillStyle="white",ot.fillText(n,e,80+35*t)}}(`X: ${Et.mapPosition.x.toFixed(0)}\nY: ${Et.mapPosition.y.toFixed(0)}\nZoom: ${ct.zoom.toFixed(2)}`,rt-200);let e=300,n=e*pt.ratio,r=rt-(n+25),s=st-325;ot.drawImage(et,r,s,n,e);let a=rt/dt*n/ct.realZoom,c=st/ft*e/ct.realZoom,l=r+ct.x/dt*n/Math.min(yt.width,yt.height),h=s+ct.y/ft*e/Math.min(yt.width,yt.height);ot.strokeStyle="red",ot.lineWidth=.5,ot.strokeRect(l,h,a,c);let u=ot.createLinearGradient(l,h,l+a,h+c);u.addColorStop(0,"rgba(255, 100, 100, 0.33)"),u.addColorStop(.5,"rgba(255, 100, 100, 0.1)"),u.addColorStop(1,"rgba(255, 100, 100, 0.3)"),ot.fillStyle=u,ot.fillRect(l,h,a,c);for(let e of i)e.draw(ot,t,Et);if(m(ot,t,Et),"move"===L){const t=20,e=3;ot.strokeStyle="white",ot.lineWidth=e,ot.beginPath(),ot.moveTo(Et.canvasPosition.x-t,Et.canvasPosition.y),ot.lineTo(Et.canvasPosition.x+t,Et.canvasPosition.y),ot.stroke(),ot.beginPath(),ot.moveTo(Et.canvasPosition.x,Et.canvasPosition.y-t),ot.lineTo(Et.canvasPosition.x,Et.canvasPosition.y+t),ot.stroke(),ot.strokeStyle="black",ot.lineWidth=1,ot.beginPath(),ot.moveTo(Et.canvasPosition.x-t-1,Et.canvasPosition.y),ot.lineTo(Et.canvasPosition.x+t+1,Et.canvasPosition.y),ot.stroke(),ot.beginPath(),ot.moveTo(Et.canvasPosition.x,Et.canvasPosition.y-t-1),ot.lineTo(Et.canvasPosition.x,Et.canvasPosition.y+t+1),ot.stroke()}else if("build"===L);else{ot.fillStyle="lightblue",ot.strokeStyle="black",ot.lineWidth=5;let t=ot.lineWidth/2;ot.beginPath(),ot.moveTo(Et.canvasPosition.x+t,Et.canvasPosition.y+t),ot.lineTo(Et.canvasPosition.x+t,Et.canvasPosition.y+45-t),ot.lineTo(Et.canvasPosition.x+15-t,Et.canvasPosition.y+30-t),ot.lineTo(Et.canvasPosition.x+37.5-t,Et.canvasPosition.y+30-t),ot.closePath(),ot.fill(),ot.stroke()}}(ut),requestAnimationFrame(t)}(0),window.addEventListener("resize",Ct)},9306:(t,e,n)=>{var o=n(4901),i=n(6823),r=TypeError;t.exports=function(t){if(o(t))return t;throw new r(i(t)+" is not a function")}},3506:(t,e,n)=>{var o=n(3925),i=String,r=TypeError;t.exports=function(t){if(o(t))return t;throw new r("Can't set "+i(t)+" as a prototype")}},7080:(t,e,n)=>{var o=n(4402).has;t.exports=function(t){return o(t),t}},8551:(t,e,n)=>{var o=n(34),i=String,r=TypeError;t.exports=function(t){if(o(t))return t;throw new r(i(t)+" is not an object")}},7811:t=>{t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},7394:(t,e,n)=>{var o=n(4576),i=n(6706),r=n(2195),s=o.ArrayBuffer,a=o.TypeError;t.exports=s&&i(s.prototype,"byteLength","get")||function(t){if("ArrayBuffer"!==r(t))throw new a("ArrayBuffer expected");return t.byteLength}},3238:(t,e,n)=>{var o=n(4576),i=n(7476),r=n(7394),s=o.ArrayBuffer,a=s&&s.prototype,c=a&&i(a.slice);t.exports=function(t){if(0!==r(t))return!1;if(!c)return!1;try{return c(t,0,0),!1}catch(t){return!0}}},5169:(t,e,n)=>{var o=n(3238),i=TypeError;t.exports=function(t){if(o(t))throw new i("ArrayBuffer is detached");return t}},5636:(t,e,n)=>{var o=n(4576),i=n(9504),r=n(6706),s=n(7696),a=n(5169),c=n(7394),l=n(4483),h=n(1548),u=o.structuredClone,p=o.ArrayBuffer,d=o.DataView,f=Math.min,y=p.prototype,v=d.prototype,g=i(y.slice),m=r(y,"resizable","get"),x=r(y,"maxByteLength","get"),w=i(v.getInt8),b=i(v.setInt8);t.exports=(h||l)&&function(t,e,n){var o,i=c(t),r=void 0===e?i:s(e),y=!m||!m(t);if(a(t),h&&(t=u(t,{transfer:[t]}),i===r&&(n||y)))return t;if(i>=r&&(!n||y))o=g(t,0,r);else{var v=n&&!y&&x?{maxByteLength:x(t)}:void 0;o=new p(r,v);for(var E=new d(t),P=new d(o),S=f(r,i),T=0;T<S;T++)b(P,T,w(E,T))}return h||l(t),o}},4644:(t,e,n)=>{var o,i,r,s=n(7811),a=n(3724),c=n(4576),l=n(4901),h=n(34),u=n(9297),p=n(6955),d=n(6823),f=n(6699),y=n(6840),v=n(2106),g=n(1625),m=n(2787),x=n(2967),w=n(8227),b=n(3392),E=n(1181),P=E.enforce,S=E.get,T=c.Int8Array,M=T&&T.prototype,O=c.Uint8ClampedArray,_=O&&O.prototype,A=T&&m(T),k=M&&m(M),I=Object.prototype,L=c.TypeError,D=w("toStringTag"),C=b("TYPED_ARRAY_TAG"),R="TypedArrayConstructor",H=s&&!!x&&"Opera"!==p(c.opera),B=!1,j={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},N={BigInt64Array:8,BigUint64Array:8},W=function(t){var e=m(t);if(h(e)){var n=S(e);return n&&u(n,R)?n[R]:W(e)}},z=function(t){if(!h(t))return!1;var e=p(t);return u(j,e)||u(N,e)};for(o in j)(r=(i=c[o])&&i.prototype)?P(r)[R]=i:H=!1;for(o in N)(r=(i=c[o])&&i.prototype)&&(P(r)[R]=i);if((!H||!l(A)||A===Function.prototype)&&(A=function(){throw new L("Incorrect invocation")},H))for(o in j)c[o]&&x(c[o],A);if((!H||!k||k===I)&&(k=A.prototype,H))for(o in j)c[o]&&x(c[o].prototype,k);if(H&&m(_)!==k&&x(_,k),a&&!u(k,D))for(o in B=!0,v(k,D,{configurable:!0,get:function(){return h(this)?this[C]:void 0}}),j)c[o]&&f(c[o],C,o);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:H,TYPED_ARRAY_TAG:B&&C,aTypedArray:function(t){if(z(t))return t;throw new L("Target is not a typed array")},aTypedArrayConstructor:function(t){if(l(t)&&(!x||g(A,t)))return t;throw new L(d(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,n,o){if(a){if(n)for(var i in j){var r=c[i];if(r&&u(r.prototype,t))try{delete r.prototype[t]}catch(n){try{r.prototype[t]=e}catch(t){}}}k[t]&&!n||y(k,t,n?e:H&&M[t]||e,o)}},exportTypedArrayStaticMethod:function(t,e,n){var o,i;if(a){if(x){if(n)for(o in j)if((i=c[o])&&u(i,t))try{delete i[t]}catch(t){}if(A[t]&&!n)return;try{return y(A,t,n?e:H&&A[t]||e)}catch(t){}}for(o in j)!(i=c[o])||i[t]&&!n||y(i,t,e)}},getTypedArrayConstructor:W,isView:function(t){if(!h(t))return!1;var e=p(t);return"DataView"===e||u(j,e)||u(N,e)},isTypedArray:z,TypedArray:A,TypedArrayPrototype:k}},5370:(t,e,n)=>{var o=n(6198);t.exports=function(t,e,n){for(var i=0,r=arguments.length>2?n:o(e),s=new t(r);r>i;)s[i]=e[i++];return s}},9617:(t,e,n)=>{var o=n(5397),i=n(5610),r=n(6198),s=function(t){return function(e,n,s){var a=o(e),c=r(a);if(0===c)return!t&&-1;var l,h=i(s,c);if(t&&n!=n){for(;c>h;)if((l=a[h++])!=l)return!0}else for(;c>h;h++)if((t||h in a)&&a[h]===n)return t||h||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},4527:(t,e,n)=>{var o=n(3724),i=n(4376),r=TypeError,s=Object.getOwnPropertyDescriptor,a=o&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=a?function(t,e){if(i(t)&&!s(t,"length").writable)throw new r("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},7628:(t,e,n)=>{var o=n(6198);t.exports=function(t,e){for(var n=o(t),i=new e(n),r=0;r<n;r++)i[r]=t[n-r-1];return i}},9928:(t,e,n)=>{var o=n(6198),i=n(1291),r=RangeError;t.exports=function(t,e,n,s){var a=o(t),c=i(n),l=c<0?a+c:c;if(l>=a||l<0)throw new r("Incorrect index");for(var h=new e(a),u=0;u<a;u++)h[u]=u===l?s:t[u];return h}},2195:(t,e,n)=>{var o=n(9504),i=o({}.toString),r=o("".slice);t.exports=function(t){return r(i(t),8,-1)}},6955:(t,e,n)=>{var o=n(2140),i=n(4901),r=n(2195),s=n(8227)("toStringTag"),a=Object,c="Arguments"===r(function(){return arguments}());t.exports=o?r:function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=a(t),s))?n:c?r(e):"Object"===(o=r(e))&&i(e.callee)?"Arguments":o}},7740:(t,e,n)=>{var o=n(9297),i=n(5031),r=n(7347),s=n(4913);t.exports=function(t,e,n){for(var a=i(e),c=s.f,l=r.f,h=0;h<a.length;h++){var u=a[h];o(t,u)||n&&o(n,u)||c(t,u,l(e,u))}}},2211:(t,e,n)=>{var o=n(9039);t.exports=!o((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},6699:(t,e,n)=>{var o=n(3724),i=n(4913),r=n(6980);t.exports=o?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},6980:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},2106:(t,e,n)=>{var o=n(283),i=n(4913);t.exports=function(t,e,n){return n.get&&o(n.get,e,{getter:!0}),n.set&&o(n.set,e,{setter:!0}),i.f(t,e,n)}},6840:(t,e,n)=>{var o=n(4901),i=n(4913),r=n(283),s=n(9433);t.exports=function(t,e,n,a){a||(a={});var c=a.enumerable,l=void 0!==a.name?a.name:e;if(o(n)&&r(n,l,a),a.global)c?t[e]=n:s(e,n);else{try{a.unsafe?t[e]&&(c=!0):delete t[e]}catch(t){}c?t[e]=n:i.f(t,e,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return t}},9433:(t,e,n)=>{var o=n(4576),i=Object.defineProperty;t.exports=function(t,e){try{i(o,t,{value:e,configurable:!0,writable:!0})}catch(n){o[t]=e}return e}},3724:(t,e,n)=>{var o=n(9039);t.exports=!o((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4483:(t,e,n)=>{var o,i,r,s,a=n(4576),c=n(9429),l=n(1548),h=a.structuredClone,u=a.ArrayBuffer,p=a.MessageChannel,d=!1;if(l)d=function(t){h(t,{transfer:[t]})};else if(u)try{p||(o=c("worker_threads"))&&(p=o.MessageChannel),p&&(i=new p,r=new u(2),s=function(t){i.port1.postMessage(null,[t])},2===r.byteLength&&(s(r),0===r.byteLength&&(d=s)))}catch(t){}t.exports=d},4055:(t,e,n)=>{var o=n(4576),i=n(34),r=o.document,s=i(r)&&i(r.createElement);t.exports=function(t){return s?r.createElement(t):{}}},6837:t=>{var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},8727:t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},6193:(t,e,n)=>{var o=n(4215);t.exports="NODE"===o},2839:(t,e,n)=>{var o=n(4576).navigator,i=o&&o.userAgent;t.exports=i?String(i):""},9519:(t,e,n)=>{var o,i,r=n(4576),s=n(2839),a=r.process,c=r.Deno,l=a&&a.versions||c&&c.version,h=l&&l.v8;h&&(i=(o=h.split("."))[0]>0&&o[0]<4?1:+(o[0]+o[1])),!i&&s&&(!(o=s.match(/Edge\/(\d+)/))||o[1]>=74)&&(o=s.match(/Chrome\/(\d+)/))&&(i=+o[1]),t.exports=i},4215:(t,e,n)=>{var o=n(4576),i=n(2839),r=n(2195),s=function(t){return i.slice(0,t.length)===t};t.exports=s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":o.Bun&&"string"==typeof Bun.version?"BUN":o.Deno&&"object"==typeof Deno.version?"DENO":"process"===r(o.process)?"NODE":o.window&&o.document?"BROWSER":"REST"},6518:(t,e,n)=>{var o=n(4576),i=n(7347).f,r=n(6699),s=n(6840),a=n(9433),c=n(7740),l=n(2796);t.exports=function(t,e){var n,h,u,p,d,f=t.target,y=t.global,v=t.stat;if(n=y?o:v?o[f]||a(f,{}):o[f]&&o[f].prototype)for(h in e){if(p=e[h],u=t.dontCallGetSet?(d=i(n,h))&&d.value:n[h],!l(y?h:f+(v?".":"#")+h,t.forced)&&void 0!==u){if(typeof p==typeof u)continue;c(p,u)}(t.sham||u&&u.sham)&&r(p,"sham",!0),s(n,h,p,t)}}},9039:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},616:(t,e,n)=>{var o=n(9039);t.exports=!o((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},9565:(t,e,n)=>{var o=n(616),i=Function.prototype.call;t.exports=o?i.bind(i):function(){return i.apply(i,arguments)}},350:(t,e,n)=>{var o=n(3724),i=n(9297),r=Function.prototype,s=o&&Object.getOwnPropertyDescriptor,a=i(r,"name"),c=a&&"something"===function(){}.name,l=a&&(!o||o&&s(r,"name").configurable);t.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},6706:(t,e,n)=>{var o=n(9504),i=n(9306);t.exports=function(t,e,n){try{return o(i(Object.getOwnPropertyDescriptor(t,e)[n]))}catch(t){}}},7476:(t,e,n)=>{var o=n(2195),i=n(9504);t.exports=function(t){if("Function"===o(t))return i(t)}},9504:(t,e,n)=>{var o=n(616),i=Function.prototype,r=i.call,s=o&&i.bind.bind(r,r);t.exports=o?s:function(t){return function(){return r.apply(t,arguments)}}},9429:(t,e,n)=>{var o=n(4576),i=n(6193);t.exports=function(t){if(i){try{return o.process.getBuiltinModule(t)}catch(t){}try{return Function('return require("'+t+'")')()}catch(t){}}}},7751:(t,e,n)=>{var o=n(4576),i=n(4901);t.exports=function(t,e){return arguments.length<2?(n=o[t],i(n)?n:void 0):o[t]&&o[t][e];var n}},1767:t=>{t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},5966:(t,e,n)=>{var o=n(9306),i=n(4117);t.exports=function(t,e){var n=t[e];return i(n)?void 0:o(n)}},3789:(t,e,n)=>{var o=n(9306),i=n(8551),r=n(9565),s=n(1291),a=n(1767),c="Invalid size",l=RangeError,h=TypeError,u=Math.max,p=function(t,e){this.set=t,this.size=u(e,0),this.has=o(t.has),this.keys=o(t.keys)};p.prototype={getIterator:function(){return a(i(r(this.keys,this.set)))},includes:function(t){return r(this.has,this.set,t)}},t.exports=function(t){i(t);var e=+t.size;if(e!=e)throw new h(c);var n=s(e);if(n<0)throw new l(c);return new p(t,n)}},4576:function(t,e,n){var o=function(t){return t&&t.Math===Math&&t};t.exports=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof n.g&&n.g)||o("object"==typeof this&&this)||function(){return this}()||Function("return this")()},9297:(t,e,n)=>{var o=n(9504),i=n(8981),r=o({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return r(i(t),e)}},421:t=>{t.exports={}},5917:(t,e,n)=>{var o=n(3724),i=n(9039),r=n(4055);t.exports=!o&&!i((function(){return 7!==Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},7055:(t,e,n)=>{var o=n(9504),i=n(9039),r=n(2195),s=Object,a=o("".split);t.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(t){return"String"===r(t)?a(t,""):s(t)}:s},3706:(t,e,n)=>{var o=n(9504),i=n(4901),r=n(7629),s=o(Function.toString);i(r.inspectSource)||(r.inspectSource=function(t){return s(t)}),t.exports=r.inspectSource},1181:(t,e,n)=>{var o,i,r,s=n(8622),a=n(4576),c=n(34),l=n(6699),h=n(9297),u=n(7629),p=n(6119),d=n(421),f="Object already initialized",y=a.TypeError,v=a.WeakMap;if(s||u.state){var g=u.state||(u.state=new v);g.get=g.get,g.has=g.has,g.set=g.set,o=function(t,e){if(g.has(t))throw new y(f);return e.facade=t,g.set(t,e),e},i=function(t){return g.get(t)||{}},r=function(t){return g.has(t)}}else{var m=p("state");d[m]=!0,o=function(t,e){if(h(t,m))throw new y(f);return e.facade=t,l(t,m,e),e},i=function(t){return h(t,m)?t[m]:{}},r=function(t){return h(t,m)}}t.exports={set:o,get:i,has:r,enforce:function(t){return r(t)?i(t):o(t,{})},getterFor:function(t){return function(e){var n;if(!c(e)||(n=i(e)).type!==t)throw new y("Incompatible receiver, "+t+" required");return n}}}},4376:(t,e,n)=>{var o=n(2195);t.exports=Array.isArray||function(t){return"Array"===o(t)}},1108:(t,e,n)=>{var o=n(6955);t.exports=function(t){var e=o(t);return"BigInt64Array"===e||"BigUint64Array"===e}},4901:t=>{var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},2796:(t,e,n)=>{var o=n(9039),i=n(4901),r=/#|\.prototype\./,s=function(t,e){var n=c[a(t)];return n===h||n!==l&&(i(e)?o(e):!!e)},a=s.normalize=function(t){return String(t).replace(r,".").toLowerCase()},c=s.data={},l=s.NATIVE="N",h=s.POLYFILL="P";t.exports=s},4117:t=>{t.exports=function(t){return null==t}},34:(t,e,n)=>{var o=n(4901);t.exports=function(t){return"object"==typeof t?null!==t:o(t)}},3925:(t,e,n)=>{var o=n(34);t.exports=function(t){return o(t)||null===t}},6395:t=>{t.exports=!1},757:(t,e,n)=>{var o=n(7751),i=n(4901),r=n(1625),s=n(7040),a=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=o("Symbol");return i(e)&&r(e.prototype,a(t))}},507:(t,e,n)=>{var o=n(9565);t.exports=function(t,e,n){for(var i,r,s=n?t:t.iterator,a=t.next;!(i=o(a,s)).done;)if(void 0!==(r=e(i.value)))return r}},9539:(t,e,n)=>{var o=n(9565),i=n(8551),r=n(5966);t.exports=function(t,e,n){var s,a;i(t);try{if(!(s=r(t,"return"))){if("throw"===e)throw n;return n}s=o(s,t)}catch(t){a=!0,s=t}if("throw"===e)throw n;if(a)throw s;return i(s),n}},6198:(t,e,n)=>{var o=n(8014);t.exports=function(t){return o(t.length)}},283:(t,e,n)=>{var o=n(9504),i=n(9039),r=n(4901),s=n(9297),a=n(3724),c=n(350).CONFIGURABLE,l=n(3706),h=n(1181),u=h.enforce,p=h.get,d=String,f=Object.defineProperty,y=o("".slice),v=o("".replace),g=o([].join),m=a&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),x=String(String).split("String"),w=t.exports=function(t,e,n){"Symbol("===y(d(e),0,7)&&(e="["+v(d(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!s(t,"name")||c&&t.name!==e)&&(a?f(t,"name",{value:e,configurable:!0}):t.name=e),m&&n&&s(n,"arity")&&t.length!==n.arity&&f(t,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var o=u(t);return s(o,"source")||(o.source=g(x,"string"==typeof e?e:"")),t};Function.prototype.toString=w((function(){return r(this)&&p(this).source||l(this)}),"toString")},741:t=>{var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(t){var o=+t;return(o>0?n:e)(o)}},4913:(t,e,n)=>{var o=n(3724),i=n(5917),r=n(8686),s=n(8551),a=n(6969),c=TypeError,l=Object.defineProperty,h=Object.getOwnPropertyDescriptor,u="enumerable",p="configurable",d="writable";e.f=o?r?function(t,e,n){if(s(t),e=a(e),s(n),"function"==typeof t&&"prototype"===e&&"value"in n&&d in n&&!n[d]){var o=h(t,e);o&&o[d]&&(t[e]=n.value,n={configurable:p in n?n[p]:o[p],enumerable:u in n?n[u]:o[u],writable:!1})}return l(t,e,n)}:l:function(t,e,n){if(s(t),e=a(e),s(n),i)try{return l(t,e,n)}catch(t){}if("get"in n||"set"in n)throw new c("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},7347:(t,e,n)=>{var o=n(3724),i=n(9565),r=n(8773),s=n(6980),a=n(5397),c=n(6969),l=n(9297),h=n(5917),u=Object.getOwnPropertyDescriptor;e.f=o?u:function(t,e){if(t=a(t),e=c(e),h)try{return u(t,e)}catch(t){}if(l(t,e))return s(!i(r.f,t,e),t[e])}},8480:(t,e,n)=>{var o=n(1828),i=n(8727).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,i)}},3717:(t,e)=>{e.f=Object.getOwnPropertySymbols},2787:(t,e,n)=>{var o=n(9297),i=n(4901),r=n(8981),s=n(6119),a=n(2211),c=s("IE_PROTO"),l=Object,h=l.prototype;t.exports=a?l.getPrototypeOf:function(t){var e=r(t);if(o(e,c))return e[c];var n=e.constructor;return i(n)&&e instanceof n?n.prototype:e instanceof l?h:null}},1625:(t,e,n)=>{var o=n(9504);t.exports=o({}.isPrototypeOf)},1828:(t,e,n)=>{var o=n(9504),i=n(9297),r=n(5397),s=n(9617).indexOf,a=n(421),c=o([].push);t.exports=function(t,e){var n,o=r(t),l=0,h=[];for(n in o)!i(a,n)&&i(o,n)&&c(h,n);for(;e.length>l;)i(o,n=e[l++])&&(~s(h,n)||c(h,n));return h}},8773:(t,e)=>{var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!n.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:n},2967:(t,e,n)=>{var o=n(6706),i=n(34),r=n(7750),s=n(3506);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{(t=o(Object.prototype,"__proto__","set"))(n,[]),e=n instanceof Array}catch(t){}return function(n,o){return r(n),s(o),i(n)?(e?t(n,o):n.__proto__=o,n):n}}():void 0)},4270:(t,e,n)=>{var o=n(9565),i=n(4901),r=n(34),s=TypeError;t.exports=function(t,e){var n,a;if("string"===e&&i(n=t.toString)&&!r(a=o(n,t)))return a;if(i(n=t.valueOf)&&!r(a=o(n,t)))return a;if("string"!==e&&i(n=t.toString)&&!r(a=o(n,t)))return a;throw new s("Can't convert object to primitive value")}},5031:(t,e,n)=>{var o=n(7751),i=n(9504),r=n(8480),s=n(3717),a=n(8551),c=i([].concat);t.exports=o("Reflect","ownKeys")||function(t){var e=r.f(a(t)),n=s.f;return n?c(e,n(t)):e}},7750:(t,e,n)=>{var o=n(4117),i=TypeError;t.exports=function(t){if(o(t))throw new i("Can't call method on "+t);return t}},9286:(t,e,n)=>{var o=n(4402),i=n(8469),r=o.Set,s=o.add;t.exports=function(t){var e=new r;return i(t,(function(t){s(e,t)})),e}},3440:(t,e,n)=>{var o=n(7080),i=n(4402),r=n(9286),s=n(5170),a=n(3789),c=n(8469),l=n(507),h=i.has,u=i.remove;t.exports=function(t){var e=o(this),n=a(t),i=r(e);return s(e)<=n.size?c(e,(function(t){n.includes(t)&&u(i,t)})):l(n.getIterator(),(function(t){h(e,t)&&u(i,t)})),i}},4402:(t,e,n)=>{var o=n(9504),i=Set.prototype;t.exports={Set,add:o(i.add),has:o(i.has),remove:o(i.delete),proto:i}},8750:(t,e,n)=>{var o=n(7080),i=n(4402),r=n(5170),s=n(3789),a=n(8469),c=n(507),l=i.Set,h=i.add,u=i.has;t.exports=function(t){var e=o(this),n=s(t),i=new l;return r(e)>n.size?c(n.getIterator(),(function(t){u(e,t)&&h(i,t)})):a(e,(function(t){n.includes(t)&&h(i,t)})),i}},4449:(t,e,n)=>{var o=n(7080),i=n(4402).has,r=n(5170),s=n(3789),a=n(8469),c=n(507),l=n(9539);t.exports=function(t){var e=o(this),n=s(t);if(r(e)<=n.size)return!1!==a(e,(function(t){if(n.includes(t))return!1}),!0);var h=n.getIterator();return!1!==c(h,(function(t){if(i(e,t))return l(h,"normal",!1)}))}},3838:(t,e,n)=>{var o=n(7080),i=n(5170),r=n(8469),s=n(3789);t.exports=function(t){var e=o(this),n=s(t);return!(i(e)>n.size)&&!1!==r(e,(function(t){if(!n.includes(t))return!1}),!0)}},8527:(t,e,n)=>{var o=n(7080),i=n(4402).has,r=n(5170),s=n(3789),a=n(507),c=n(9539);t.exports=function(t){var e=o(this),n=s(t);if(r(e)<n.size)return!1;var l=n.getIterator();return!1!==a(l,(function(t){if(!i(e,t))return c(l,"normal",!1)}))}},8469:(t,e,n)=>{var o=n(9504),i=n(507),r=n(4402),s=r.Set,a=r.proto,c=o(a.forEach),l=o(a.keys),h=l(new s).next;t.exports=function(t,e,n){return n?i({iterator:l(t),next:h},e):c(t,e)}},4916:(t,e,n)=>{var o=n(7751),i=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}};t.exports=function(t){var e=o("Set");try{(new e)[t](i(0));try{return(new e)[t](i(-1)),!1}catch(t){return!0}}catch(t){return!1}}},5170:(t,e,n)=>{var o=n(6706),i=n(4402);t.exports=o(i.proto,"size","get")||function(t){return t.size}},3650:(t,e,n)=>{var o=n(7080),i=n(4402),r=n(9286),s=n(3789),a=n(507),c=i.add,l=i.has,h=i.remove;t.exports=function(t){var e=o(this),n=s(t).getIterator(),i=r(e);return a(n,(function(t){l(e,t)?h(i,t):c(i,t)})),i}},4204:(t,e,n)=>{var o=n(7080),i=n(4402).add,r=n(9286),s=n(3789),a=n(507);t.exports=function(t){var e=o(this),n=s(t).getIterator(),c=r(e);return a(n,(function(t){i(c,t)})),c}},6119:(t,e,n)=>{var o=n(5745),i=n(3392),r=o("keys");t.exports=function(t){return r[t]||(r[t]=i(t))}},7629:(t,e,n)=>{var o=n(6395),i=n(4576),r=n(9433),s="__core-js_shared__",a=t.exports=i[s]||r(s,{});(a.versions||(a.versions=[])).push({version:"3.38.1",mode:o?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"})},5745:(t,e,n)=>{var o=n(7629);t.exports=function(t,e){return o[t]||(o[t]=e||{})}},1548:(t,e,n)=>{var o=n(4576),i=n(9039),r=n(9519),s=n(4215),a=o.structuredClone;t.exports=!!a&&!i((function(){if("DENO"===s&&r>92||"NODE"===s&&r>94||"BROWSER"===s&&r>97)return!1;var t=new ArrayBuffer(8),e=a(t,{transfer:[t]});return 0!==t.byteLength||8!==e.byteLength}))},4495:(t,e,n)=>{var o=n(9519),i=n(9039),r=n(4576).String;t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol("symbol detection");return!r(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&o&&o<41}))},5610:(t,e,n)=>{var o=n(1291),i=Math.max,r=Math.min;t.exports=function(t,e){var n=o(t);return n<0?i(n+e,0):r(n,e)}},5854:(t,e,n)=>{var o=n(2777),i=TypeError;t.exports=function(t){var e=o(t,"number");if("number"==typeof e)throw new i("Can't convert number to bigint");return BigInt(e)}},7696:(t,e,n)=>{var o=n(1291),i=n(8014),r=RangeError;t.exports=function(t){if(void 0===t)return 0;var e=o(t),n=i(e);if(e!==n)throw new r("Wrong length or index");return n}},5397:(t,e,n)=>{var o=n(7055),i=n(7750);t.exports=function(t){return o(i(t))}},1291:(t,e,n)=>{var o=n(741);t.exports=function(t){var e=+t;return e!=e||0===e?0:o(e)}},8014:(t,e,n)=>{var o=n(1291),i=Math.min;t.exports=function(t){var e=o(t);return e>0?i(e,9007199254740991):0}},8981:(t,e,n)=>{var o=n(7750),i=Object;t.exports=function(t){return i(o(t))}},2777:(t,e,n)=>{var o=n(9565),i=n(34),r=n(757),s=n(5966),a=n(4270),c=n(8227),l=TypeError,h=c("toPrimitive");t.exports=function(t,e){if(!i(t)||r(t))return t;var n,c=s(t,h);if(c){if(void 0===e&&(e="default"),n=o(c,t,e),!i(n)||r(n))return n;throw new l("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},6969:(t,e,n)=>{var o=n(2777),i=n(757);t.exports=function(t){var e=o(t,"string");return i(e)?e:e+""}},2140:(t,e,n)=>{var o={};o[n(8227)("toStringTag")]="z",t.exports="[object z]"===String(o)},6823:t=>{var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},3392:(t,e,n)=>{var o=n(9504),i=0,r=Math.random(),s=o(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++i+r,36)}},7040:(t,e,n)=>{var o=n(4495);t.exports=o&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},8686:(t,e,n)=>{var o=n(3724),i=n(9039);t.exports=o&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},8622:(t,e,n)=>{var o=n(4576),i=n(4901),r=o.WeakMap;t.exports=i(r)&&/native code/.test(String(r))},8227:(t,e,n)=>{var o=n(4576),i=n(5745),r=n(9297),s=n(3392),a=n(4495),c=n(7040),l=o.Symbol,h=i("wks"),u=c?l.for||l:l&&l.withoutSetter||s;t.exports=function(t){return r(h,t)||(h[t]=a&&r(l,t)?l[t]:u("Symbol."+t)),h[t]}},6573:(t,e,n)=>{var o=n(3724),i=n(2106),r=n(3238),s=ArrayBuffer.prototype;o&&!("detached"in s)&&i(s,"detached",{configurable:!0,get:function(){return r(this)}})},7936:(t,e,n)=>{var o=n(6518),i=n(5636);i&&o({target:"ArrayBuffer",proto:!0},{transferToFixedLength:function(){return i(this,arguments.length?arguments[0]:void 0,!1)}})},8100:(t,e,n)=>{var o=n(6518),i=n(5636);i&&o({target:"ArrayBuffer",proto:!0},{transfer:function(){return i(this,arguments.length?arguments[0]:void 0,!0)}})},4114:(t,e,n)=>{var o=n(6518),i=n(8981),r=n(6198),s=n(4527),a=n(6837);o({target:"Array",proto:!0,arity:1,forced:n(9039)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=i(this),n=r(e),o=arguments.length;a(n+o);for(var c=0;c<o;c++)e[n]=arguments[c],n++;return s(e,n),n}})},7642:(t,e,n)=>{var o=n(6518),i=n(3440);o({target:"Set",proto:!0,real:!0,forced:!n(4916)("difference")},{difference:i})},8004:(t,e,n)=>{var o=n(6518),i=n(9039),r=n(8750);o({target:"Set",proto:!0,real:!0,forced:!n(4916)("intersection")||i((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}))},{intersection:r})},3853:(t,e,n)=>{var o=n(6518),i=n(4449);o({target:"Set",proto:!0,real:!0,forced:!n(4916)("isDisjointFrom")},{isDisjointFrom:i})},5876:(t,e,n)=>{var o=n(6518),i=n(3838);o({target:"Set",proto:!0,real:!0,forced:!n(4916)("isSubsetOf")},{isSubsetOf:i})},2475:(t,e,n)=>{var o=n(6518),i=n(8527);o({target:"Set",proto:!0,real:!0,forced:!n(4916)("isSupersetOf")},{isSupersetOf:i})},5024:(t,e,n)=>{var o=n(6518),i=n(3650);o({target:"Set",proto:!0,real:!0,forced:!n(4916)("symmetricDifference")},{symmetricDifference:i})},1698:(t,e,n)=>{var o=n(6518),i=n(4204);o({target:"Set",proto:!0,real:!0,forced:!n(4916)("union")},{union:i})},7467:(t,e,n)=>{var o=n(7628),i=n(4644),r=i.aTypedArray,s=i.exportTypedArrayMethod,a=i.getTypedArrayConstructor;s("toReversed",(function(){return o(r(this),a(this))}))},4732:(t,e,n)=>{var o=n(4644),i=n(9504),r=n(9306),s=n(5370),a=o.aTypedArray,c=o.getTypedArrayConstructor,l=o.exportTypedArrayMethod,h=i(o.TypedArrayPrototype.sort);l("toSorted",(function(t){void 0!==t&&r(t);var e=a(this),n=s(c(e),e);return h(n,t)}))},9577:(t,e,n)=>{var o=n(9928),i=n(4644),r=n(1108),s=n(1291),a=n(5854),c=i.aTypedArray,l=i.getTypedArrayConstructor,h=i.exportTypedArrayMethod,u=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(t){return 8===t}}();h("with",{with:function(t,e){var n=c(this),i=s(t),h=r(n)?a(e):+e;return o(n,l(n),i,h)}}.with,!u)},3375:(t,e,n)=>{n(7642)},9225:(t,e,n)=>{n(8004)},3972:(t,e,n)=>{n(3853)},9209:(t,e,n)=>{n(5876)},5714:(t,e,n)=>{n(2475)},7561:(t,e,n)=>{n(5024)},6197:(t,e,n)=>{n(1698)}},o={};function i(t){var e=o[t];if(void 0!==e){if(void 0!==e.error)throw e.error;return e.exports}var r=o[t]={exports:{}};try{var s={id:t,module:r,factory:n[t],require:i};i.i.forEach((function(t){t(s)})),r=s.module,s.factory.call(r.exports,r,r.exports,s.require)}catch(t){throw r.error=t,t}return r.exports}i.m=n,i.c=o,i.i=[],i.hu=t=>t+"."+i.h()+".hot-update.js",i.hmrF=()=>"main."+i.h()+".hot-update.json",i.h=()=>"b6ca4efdc953df71a4a6",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="civ:",i.l=(n,o,r,s)=>{if(t[n])t[n].push(o);else{var a,c;if(void 0!==r)for(var l=document.getElementsByTagName("script"),h=0;h<l.length;h++){var u=l[h];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==e+r){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",e+r),a.src=n),t[n]=[o];var p=(e,o)=>{a.onerror=a.onload=null,clearTimeout(d);var i=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((t=>t(o))),e)return e(o)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),c&&document.head.appendChild(a)}},(()=>{var t,e,n,o={},r=i.c,s=[],a=[],c="idle",l=0,h=[];function u(t){c=t;for(var e=[],n=0;n<a.length;n++)e[n]=a[n].call(null,t);return Promise.all(e).then((function(){}))}function p(){0==--l&&u("ready").then((function(){if(0===l){var t=h;h=[];for(var e=0;e<t.length;e++)t[e]()}}))}function d(t){if("idle"!==c)throw new Error("check() is only allowed in idle status");return u("check").then(i.hmrM).then((function(n){return n?u("prepare").then((function(){var o=[];return e=[],Promise.all(Object.keys(i.hmrC).reduce((function(t,r){return i.hmrC[r](n.c,n.r,n.m,t,e,o),t}),[])).then((function(){return e=function(){return t?y(t):u("ready").then((function(){return o}))},0===l?e():new Promise((function(t){h.push((function(){t(e())}))}));var e}))})):u(v()?"ready":"idle").then((function(){return null}))}))}function f(t){return"ready"!==c?Promise.resolve().then((function(){throw new Error("apply() is only allowed in ready status (state: "+c+")")})):y(t)}function y(t){t=t||{},v();var o=e.map((function(e){return e(t)}));e=void 0;var i=o.map((function(t){return t.error})).filter(Boolean);if(i.length>0)return u("abort").then((function(){throw i[0]}));var r=u("dispose");o.forEach((function(t){t.dispose&&t.dispose()}));var s,a=u("apply"),c=function(t){s||(s=t)},l=[];return o.forEach((function(t){if(t.apply){var e=t.apply(c);if(e)for(var n=0;n<e.length;n++)l.push(e[n])}})),Promise.all([r,a]).then((function(){return s?u("fail").then((function(){throw s})):n?y(t).then((function(t){return l.forEach((function(e){t.indexOf(e)<0&&t.push(e)})),t})):u("idle").then((function(){return l}))}))}function v(){if(n)return e||(e=[]),Object.keys(i.hmrI).forEach((function(t){n.forEach((function(n){i.hmrI[t](n,e)}))})),n=void 0,!0}i.hmrD=o,i.i.push((function(h){var y,v,g,m,x=h.module,w=function(e,n){var o=r[n];if(!o)return e;var i=function(i){if(o.hot.active){if(r[i]){var a=r[i].parents;-1===a.indexOf(n)&&a.push(n)}else s=[n],t=i;-1===o.children.indexOf(i)&&o.children.push(i)}else console.warn("[HMR] unexpected require("+i+") from disposed module "+n),s=[];return e(i)},a=function(t){return{configurable:!0,enumerable:!0,get:function(){return e[t]},set:function(n){e[t]=n}}};for(var h in e)Object.prototype.hasOwnProperty.call(e,h)&&"e"!==h&&Object.defineProperty(i,h,a(h));return i.e=function(t,n){return function(t){switch(c){case"ready":u("prepare");case"prepare":return l++,t.then(p,p),t;default:return t}}(e.e(t,n))},i}(h.require,h.id);x.hot=(y=h.id,v=x,m={_acceptedDependencies:{},_acceptedErrorHandlers:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:g=t!==y,_requireSelf:function(){s=v.parents.slice(),t=g?void 0:y,i(y)},active:!0,accept:function(t,e,n){if(void 0===t)m._selfAccepted=!0;else if("function"==typeof t)m._selfAccepted=t;else if("object"==typeof t&&null!==t)for(var o=0;o<t.length;o++)m._acceptedDependencies[t[o]]=e||function(){},m._acceptedErrorHandlers[t[o]]=n;else m._acceptedDependencies[t]=e||function(){},m._acceptedErrorHandlers[t]=n},decline:function(t){if(void 0===t)m._selfDeclined=!0;else if("object"==typeof t&&null!==t)for(var e=0;e<t.length;e++)m._declinedDependencies[t[e]]=!0;else m._declinedDependencies[t]=!0},dispose:function(t){m._disposeHandlers.push(t)},addDisposeHandler:function(t){m._disposeHandlers.push(t)},removeDisposeHandler:function(t){var e=m._disposeHandlers.indexOf(t);e>=0&&m._disposeHandlers.splice(e,1)},invalidate:function(){switch(this._selfInvalidated=!0,c){case"idle":e=[],Object.keys(i.hmrI).forEach((function(t){i.hmrI[t](y,e)})),u("ready");break;case"ready":Object.keys(i.hmrI).forEach((function(t){i.hmrI[t](y,e)}));break;case"prepare":case"check":case"dispose":case"apply":(n=n||[]).push(y)}},check:d,apply:f,status:function(t){if(!t)return c;a.push(t)},addStatusHandler:function(t){a.push(t)},removeStatusHandler:function(t){var e=a.indexOf(t);e>=0&&a.splice(e,1)},data:o[y]},t=void 0,m),x.parents=s,x.children=[],s=[],h.require=w})),i.hmrC={},i.hmrI={}})(),(()=>{var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t})(),(()=>{var t,e,n,o,r,s=i.hmrS_jsonp=i.hmrS_jsonp||{792:0},a={};function c(e,n){return t=n,new Promise(((t,n)=>{a[e]=t;var o=i.p+i.hu(e),r=new Error;i.l(o,(t=>{if(a[e]){a[e]=void 0;var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;r.message="Loading hot update chunk "+e+" failed.\n("+o+": "+i+")",r.name="ChunkLoadError",r.type=o,r.request=i,n(r)}}))}))}function l(t){function a(t){for(var e=[t],n={},o=e.map((function(t){return{chain:[t],id:t}}));o.length>0;){var r=o.pop(),s=r.id,a=r.chain,l=i.c[s];if(l&&(!l.hot._selfAccepted||l.hot._selfInvalidated)){if(l.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:s};if(l.hot._main)return{type:"unaccepted",chain:a,moduleId:s};for(var h=0;h<l.parents.length;h++){var u=l.parents[h],p=i.c[u];if(p){if(p.hot._declinedDependencies[s])return{type:"declined",chain:a.concat([u]),moduleId:s,parentId:u};-1===e.indexOf(u)&&(p.hot._acceptedDependencies[s]?(n[u]||(n[u]=[]),c(n[u],[s])):(delete n[u],e.push(u),o.push({chain:a.concat([u]),id:u})))}}}}return{type:"accepted",moduleId:t,outdatedModules:e,outdatedDependencies:n}}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];-1===t.indexOf(o)&&t.push(o)}}i.f&&delete i.f.jsonpHmr,e=void 0;var l={},h=[],u={},p=function(t){console.warn("[HMR] unexpected require("+t.id+") to disposed module")};for(var d in n)if(i.o(n,d)){var f=n[d],y=f?a(d):{type:"disposed",moduleId:d},v=!1,g=!1,m=!1,x="";switch(y.chain&&(x="\nUpdate propagation: "+y.chain.join(" -> ")),y.type){case"self-declined":t.onDeclined&&t.onDeclined(y),t.ignoreDeclined||(v=new Error("Aborted because of self decline: "+y.moduleId+x));break;case"declined":t.onDeclined&&t.onDeclined(y),t.ignoreDeclined||(v=new Error("Aborted because of declined dependency: "+y.moduleId+" in "+y.parentId+x));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(y),t.ignoreUnaccepted||(v=new Error("Aborted because "+d+" is not accepted"+x));break;case"accepted":t.onAccepted&&t.onAccepted(y),g=!0;break;case"disposed":t.onDisposed&&t.onDisposed(y),m=!0;break;default:throw new Error("Unexception type "+y.type)}if(v)return{error:v};if(g)for(d in u[d]=f,c(h,y.outdatedModules),y.outdatedDependencies)i.o(y.outdatedDependencies,d)&&(l[d]||(l[d]=[]),c(l[d],y.outdatedDependencies[d]));m&&(c(h,[y.moduleId]),u[d]=p)}n=void 0;for(var w,b=[],E=0;E<h.length;E++){var P=h[E],S=i.c[P];S&&(S.hot._selfAccepted||S.hot._main)&&u[P]!==p&&!S.hot._selfInvalidated&&b.push({module:P,require:S.hot._requireSelf,errorHandler:S.hot._selfAccepted})}return{dispose:function(){var t;o.forEach((function(t){delete s[t]})),o=void 0;for(var e,n=h.slice();n.length>0;){var r=n.pop(),a=i.c[r];if(a){var c={},u=a.hot._disposeHandlers;for(E=0;E<u.length;E++)u[E].call(null,c);for(i.hmrD[r]=c,a.hot.active=!1,delete i.c[r],delete l[r],E=0;E<a.children.length;E++){var p=i.c[a.children[E]];p&&(t=p.parents.indexOf(r))>=0&&p.parents.splice(t,1)}}}for(var d in l)if(i.o(l,d)&&(a=i.c[d]))for(w=l[d],E=0;E<w.length;E++)e=w[E],(t=a.children.indexOf(e))>=0&&a.children.splice(t,1)},apply:function(e){for(var n in u)i.o(u,n)&&(i.m[n]=u[n]);for(var o=0;o<r.length;o++)r[o](i);for(var s in l)if(i.o(l,s)){var a=i.c[s];if(a){w=l[s];for(var c=[],p=[],d=[],f=0;f<w.length;f++){var y=w[f],v=a.hot._acceptedDependencies[y],g=a.hot._acceptedErrorHandlers[y];if(v){if(-1!==c.indexOf(v))continue;c.push(v),p.push(g),d.push(y)}}for(var m=0;m<c.length;m++)try{c[m].call(null,w)}catch(n){if("function"==typeof p[m])try{p[m](n,{moduleId:s,dependencyId:d[m]})}catch(o){t.onErrored&&t.onErrored({type:"accept-error-handler-errored",moduleId:s,dependencyId:d[m],error:o,originalError:n}),t.ignoreErrored||(e(o),e(n))}else t.onErrored&&t.onErrored({type:"accept-errored",moduleId:s,dependencyId:d[m],error:n}),t.ignoreErrored||e(n)}}}for(var x=0;x<b.length;x++){var E=b[x],P=E.module;try{E.require(P)}catch(n){if("function"==typeof E.errorHandler)try{E.errorHandler(n,{moduleId:P,module:i.c[P]})}catch(o){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:P,error:o,originalError:n}),t.ignoreErrored||(e(o),e(n))}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:P,error:n}),t.ignoreErrored||e(n)}}return h}}}self.webpackHotUpdateciv=(e,o,s)=>{for(var c in o)i.o(o,c)&&(n[c]=o[c],t&&t.push(c));s&&r.push(s),a[e]&&(a[e](),a[e]=void 0)},i.hmrI.jsonp=function(t,e){n||(n={},r=[],o=[],e.push(l)),i.o(n,t)||(n[t]=i.m[t])},i.hmrC.jsonp=function(t,a,h,u,p,d){p.push(l),e={},o=a,n=h.reduce((function(t,e){return t[e]=!1,t}),{}),r=[],t.forEach((function(t){i.o(s,t)&&void 0!==s[t]?(u.push(c(t,d)),e[t]=!0):e[t]=!1})),i.f&&(i.f.jsonpHmr=function(t,n){e&&i.o(e,t)&&!e[t]&&(n.push(c(t)),e[t]=!0)})},i.hmrM=()=>{if("undefined"==typeof fetch)throw new Error("No browser support: need fetch API");return fetch(i.p+i.hmrF()).then((t=>{if(404!==t.status){if(!t.ok)throw new Error("Failed to fetch update manifest "+t.statusText);return t.json()}}))}})(),i(5222)})();